- name: enable dns addon dirs
  file: name={{ item }} state=directory
  with_items:
  - /root/local/addon

- name: copy dns addon yaml
  template: src=dns.yaml.j2 dest=/root/local/dns.yaml

- name: start calico network
  shell: "{{ bin_dir }}/kubectl create -f /root/local/dns.yaml && sleep 15"
  when: NODE_ID is defined and NODE_ID == "node1"
  ignore_errors: true
